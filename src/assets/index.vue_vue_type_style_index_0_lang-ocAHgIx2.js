import{d as I,v as R,r as l,b as p,c as _,e as v,f as c,w as y,u as V,R as j,g as d,t as h,F as L,i as P,S as U,T as i}from"./index-Xku4Yv_8.js";const z={class:"upload"},D={class:"el-upload__text"},q={class:"current-file flex mt10 flex items-center",style:{height:"30px"}},A={class:"mr20"},H=I({__name:"index",props:{name:{},percentage:{},status:{},size:{},response:{},uid:{},url:{default:""},raw:{},fileType:{default:()=>["text/csv","power_level"]}},emits:["on-success"],setup(x,{emit:$}){const{t}=R.useI18n(),m=x,w=$,a=l(),r=l([]),f=l(),g=l(""),u=l(0),n=l(""),E=s=>{a.value.clearFiles();const e=s[0];e.uid=U(),a.value.handleStart(e)},S=s=>{if(s.type){const e=m.fileType.includes(s.type);return e||i({title:`${t("common.tips")}!`,message:`${t("common.msg.fileBefore")}!`,type:"warning"}),e}},C=(s,e,o)=>{u.value=e.percentage,s.code===0?(n.value="success",i({title:`${t("common.tips")}!`,message:`${t("common.msg.fileSuccess")}!`,type:"success"})):(n.value="exception",i({title:`${t("common.tips")}!`,message:s.msg,type:"error"})),w("on-success")},F=(s,e,o)=>{i({title:`${t("common.tips")}!`,message:`${t("common.msg.fileError")}!`,type:"error"})},N=(s,e,o)=>{n.value="",f.value=e,g.value=e.name,u.value=e.percentage},b=(s,e)=>{var o;a.value.submit(),r.value=((o=s.response)==null?void 0:o.code)===1?[]:[s]};return(s,e)=>{const o=p("el-icon"),k=p("el-upload"),B=p("el-progress");return _(),v("div",z,[c(k,{class:"custom-upload-drag","file-list":r.value,"onUpdate:fileList":e[0]||(e[0]=T=>r.value=T),ref_key:"uploadRef",ref:a,action:m.url,drag:"","show-file-list":!1,"before-upload":S,"on-success":C,"on-error":F,"on-progress":N,"on-exceed":E,"on-change":b,limit:1,"auto-upload":!1,accept:s.fileType.join(",")},{default:y(()=>[c(o,{class:"el-icon--upload"},{default:y(()=>[c(V(j))]),_:1}),d("div",D,h(s.$t("common.msg.file")),1)]),_:1},8,["file-list","action","accept"]),d("div",q,[f.value?(_(),v(L,{key:0},[d("div",A,h(g.value),1),c(B,{class:"flex-auto",percentage:u.value,status:n.value,striped:"","striped-flow":""},null,8,["percentage","status"])],64)):P("",!0)])])}}});export{H as _};
