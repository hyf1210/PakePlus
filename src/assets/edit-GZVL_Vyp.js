import{G as v}from"./index-DXDSQOyL.js";import{d as F,v as R,N as $,Q as q,r as f,W as A,o as D,b as t,c as N,e as S,f as l,w as s,g as _,V as g}from"./index-Xku4Yv_8.js";import{a as U,g as I,b as M}from"./powerLevel-BqOPWDkb.js";import{_ as c}from"./lodash-C7R_B3uJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"app-pwower-bds-edit flex flex-auto flex-column"},Q={class:"flex-auto"},W={class:"ml50 mr50"},z={class:"flex mt20"},Z=F({__name:"edit",setup(H){const{t:b}=R.useI18n(),p=$(),y=q(),d=f(),n=f({name:""}),h=A({name:[{required:!0,message:b("common.placeholder.input")+b("table.common.filename"),trigger:"blur"}]}),r=f([]);D(()=>{p.params.name?(n.value.name=p.params.name,B(p.params.name)):x()});const x=async()=>{const{data:e}=await U({gnssType:"bds"});c(e).forEach(a=>{a.type=a.freqType.split("_")[1]}),r.value=e},V=async()=>await new Promise(e=>{d.value&&d.value.validate(a=>{e(a?n.value:!1)})}),C=async()=>{const e=await V();if(e){let a=c.forEach(r.value,u=>c.omit(u,["type"]));const o=await M("bds",e.name,a);o.code===0?g({type:"success",message:o.msg}):g({type:"error",message:o.msg}),w()}},B=async e=>{const{data:a}=await I({gnssType:"bds",fileName:e});c(a).forEach(o=>{o.type=o.freqType.split("_")[1]}),r.value=a},w=()=>{y.push("/scene/power/bds")};return(e,a)=>{const o=t("el-input"),u=t("el-form-item"),E=t("el-col"),P=t("el-row"),T=t("el-form"),i=t("el-table-column"),k=t("el-slider"),G=t("el-table");return N(),S("div",j,[l(T,{class:"flex flex flex-column",ref_key:"modelRef",ref:d,model:n.value,rules:h},{default:s(()=>[l(P,{gutter:20},{default:s(()=>[l(E,{span:12},{default:s(()=>[l(u,{class:"flex-auto",label:e.$t("table.common.filename")+"ï¼š",prop:"name"},{default:s(()=>[l(o,{modelValue:n.value.name,"onUpdate:modelValue":a[0]||(a[0]=m=>n.value.name=m)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"]),_("div",Q,[l(G,{class:"h100",data:r.value,border:"",stripe:""},{default:s(()=>[l(i,{type:"index",align:"center",label:e.$t("table.common.index"),width:"100"},null,8,["label"]),l(i,{prop:"type",align:"center",label:e.$t("table.powerBDS.type")},null,8,["label"]),l(i,{align:"center",label:e.$t("table.powerBDS.powerFactor")},{default:s(m=>[_("div",W,[l(k,{modelValue:m.row.powerFactor,"onUpdate:modelValue":L=>m.row.powerFactor=L,"show-input":"",min:-100,max:-20,step:.01},null,8,["modelValue","onUpdate:modelValue"])])]),_:1},8,["label"])]),_:1},8,["data"])]),_("div",z,[l(v,{label:"confirm",onClick:C}),l(v,{class:"ml50",label:"cancel",onClick:w})])])}}});export{Z as default};
